<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<title>ShootPoints</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- <script src="https://unpkg.com/mustache@latest/mustache.min.js"></script> -->
	<script src="lib/mustache.min.js"></script>
	<script type="text/javascript" src="scripts.js"></script>
	<link rel="stylesheet" href="styles.css">
	<link rel="icon" href="img/favicon.ico">
</head>

<body onload="
	os_check();
	load_setup_errors();
	load_atmospheric_conditions();
	load_prism_offsets();
	load_date_and_time();
	load_configs_menus();
	load_sites_menus();
	load_classes_menus();
	load_geometries_menus();
	load_current_session_info();
	load_current_grouping_info();
	livemap_recenter();
	">

	<div id="onTheFlyAdjustmentsPopup" hidden>
		<div class="formcollectionheader">
			On-The-Fly Adjustments
			<span style="float: right;"
				onclick="document.getElementById('onTheFlyAdjustmentsPopup').hidden=true">×&nbsp;</span>
		</div>
		<form id="setAtmosphericConditionsForm">
			<span><b>Set Atmospheric Conditions</b></span>
			<hr>
			<label for="setAtmosphericConditionsFormTemperature">Temperature (°C):</label>
			<input type="text" id="setAtmosphericConditionsFormTemperature" name="temperature" pattern="-?\d{1,2}"
				required />
			<label for="setAtmosphericConditionsFormPressure"><br>Pressure (mmHg):</label>
			<input type="text" id="setAtmosphericConditionsFormPressure" name="pressure" pattern="[78]\d{2}" required />
			<br>
			<input type="button" id="setAtmosphericConditionsFormButton" value="Set Atmospheric Conditions"
				onclick="set_atmospheric_conditions();" />
		</form>
		<form id="setPrismOffsetsForm">
			<span><b>Set Prism Offsets</b></span>
			<hr>
			<span style="font-size: small">(direction is in meters from prism to point, as seen from the total
				station)</span>
			<label for="setPrismOffsetsVerticalDistance"><br><span class="clearfield"
					onclick="clear_field('setPrismOffsetsVerticalDistance');">×&nbsp;</span>Vertical Offset:</label>
			<input type="text" id="setPrismOffsetsVerticalDistance" name="vertical_distance" pattern="\d\.?(\.\d{1,3})?"
				size="5" />
			<select id="setPrismOffsetsVerticalDirection" name="vertical_direction">
				<option value="-1">Down</option>
				<option value="1">Up</option>
			</select>
			<label for="setPrismOffsetsLatitudeDistance"><br><span class="clearfield"
					onclick="clear_field('setPrismOffsetsLatitudeDistance');">×&nbsp;</span>Latitude Offset:</label>
			<input type="text" id="setPrismOffsetsLatitudeDistance" name="latitude_distance" pattern="\d\.?(\.\d{1,3})?"
				size="5" />
			<select id="setPrismOffsetsLatitudeDirection" name="latitude_direction">
				<option value="1">North</option>
				<option value="-1">South</option>
			</select>
			<label for="setPrismOffsetsLongitudeDistance"><br><span class="clearfield"
					onclick="clear_field('setPrismOffsetsLongitudeDistance');">×&nbsp;</span>Longitude Offset:</label>
			<input type="text" id="setPrismOffsetsLongitudeDistance" name="longitude_distance"
				pattern="\d\.?(\.\d{1,3})?" size="5" />
			<select id="setPrismOffsetsLongitudeDirection" name="longitude_direction">
				<option value="1">East</option>
				<option value="-1">West</option>
			</select>
			<label for="setPrismOffsetsRadialDistance"><br><span class="clearfield"
					onclick="clear_field('setPrismOffsetsRadialDistance');">×&nbsp;</span>Radial Offset:</label>
			<input type="text" id="setPrismOffsetsRadialDistance" name="radial_distance" pattern="\d\.?(\.\d{1,3})?"
				size="5" />
			<select id="setPrismOffsetsRadialDirection" name="radial_direction">
				<option value="1">Away</option>
				<option value="-1">Toward</option>
			</select>
			<label for="setPrismOffsetsTangentDistance"><br><span class="clearfield"
					onclick="clear_field('setPrismOffsetsTangentDistance');">×&nbsp;</span>Tangent Offset:</label>
			<input type="text" id="setPrismOffsetsTangentDistance" name="tangent_distance" pattern="\d\.?(\.\d{1,3})?"
				size="5" />
			<select id="setPrismOffsetsTangentDirection" name="tangent_direction">
				<option value="1">Right</option>
				<option value="-1">Left</option>
			</select>
			<label for="setPrismOffsetsWedgeDistance"><br><span class="clearfield"
					onclick="clear_field('setPrismOffsetsWedgeDistance');">×&nbsp;</span>Wedge Offset:</label>
			<input type="text" id="setPrismOffsetsWedgeDistance" name="wedge_distance" pattern="\d\.?(\.\d{1,3})?"
				size="5" />
			<select id="setPrismOffsetsWedgeDirection" name="wedge_direction">
				<option value="1">Clockwise</option>
				<option value="-1">Counter-Clockwise</option>
			</select>
			<br>
			<input type="button" id="setPrismOffsetsFormButton" value="Set Prism Offsets"
				onclick="set_prism_offsets();" />
		</form>
	</div>

	<div id="utilitiesPopup" hidden>
		<div class="formcollectionheader">
			Utilities
			<span style="float: right;" onclick="document.getElementById('utilitiesPopup').hidden=true">×&nbsp;</span>
		</div>
		<form id="exportSessionDataForm">
			<span><b>Export Surveying Session Data</b></span>
			<hr>
			<a href="" id="sessionDataExportTrigger" download hidden></a>
			<label for="exportSessionDataFormSessionsMenu">Session:</label>
			<select id="exportSessionDataFormSessionsMenu" name="sessions_id"
				onchange="update_description(this, 'exportSessionDataFormSessionDescription'); toggle_button(this);"
				required>
			</select>
			<img class="infobutton" id="exportSessionDataFormSessionDescription" src="img/info.svg">
			<br>
			<input type="button" value="Export" onclick="export_session_data();" disabled />
		</form>
		<form id="downloadDatabaseForm">
			<span><b>Download the Entire ShootPoints Database</b></span>
			<hr>
			<a href="/database/" id="databaseDownloadTrigger" download hidden></a>
			<input type="button" value="Download" onclick="download_database();" />
		</form>
		<form id="deleteSessionForm">
			<span><b>Delete Session</b></span>
			<hr>
			<label for="deleteSessionFormSessionsMenu">Session:</label>
			<select id="deleteSessionFormSessionsMenu" name="sessions_id"
				onchange="update_description(this, 'deleteSessionFormSessionDescription'); toggle_button(this);"
				required>
			</select>
			<img class="infobutton" id="deleteSessionFormSessionDescription" src="img/info.svg">
			<br>
			<input type="button" value="Delete Session" onclick="delete_session();" disabled />
		</form>
		<form id="setClockForm" hidden>
			<span><b>Set the Raspberry Pi Clock</b></span>
			<hr>
			<input type="text" id="setClockFormDateTimeString" name="datetimestring" hidden />
			<input type="button" value="Set the Clock" onclick="set_rpi_clock();" />
		</form>
		<form id="shutDownForm" hidden>
			<span><b>Shut Down the Raspberry Pi</b></span>
			<hr>
			<input type="button" value="Shut Down" onclick="shut_rpi_down();" />
			<img id="shutDownFormIndicator" src="img/cylon.svg" hidden /><br>
		</form>
	</div>

	<div id="liveMapPopup" hidden>
		<div class="formcollectionheader">
			Live Map (demo)
			<span style="float: right;" onclick="document.getElementById('liveMapPopup').hidden=true">×&nbsp;</span>
		</div>
		<svg id="liveMap" preserveAspectRatio="xMinYMin slice" xmlns="http://www.w3.org/2000/svg">
			<defs>
				<marker id="surveyStationSymbol" markerWidth="10" markerHeight="10" refX="4" refY="4.3">
					<path d="M 4,1 L 7,6 L 1,6 Z" stroke="white" stroke-width="1" fill="white" opacity="0.7" />
					<g fill="none" stroke="black" stroke-width="0.5">
						<path d="M 4,1 L 7,6 L 1,6 Z" />
						<circle cx="4" cy="4.3" r="0.6" fill="black" stroke="none" />
					</g>
				</marker>
				<marker id="surveyPointSymbol" markerWidth="10" markerHeight="10" refX="2.5" refY="2.5">
					<g fill="none" stroke="white" stroke-width="1" stroke-linecap="butt" opacity="0.7">
						<path d="M 0.8,0.8 L 4.2,4.2" />
						<path d="M 4.2,0.8 L 0.8,4.2" />
					</g>
					<g fill="none" stroke="black" stroke-width="0.5">
						<path d="M 1,1 L 4,4" />
						<path d="M 4,1 L 1,4" />
					</g>
				</marker>
				<marker id="savedSurveyPointSymbol">
					<!-- container for the surveyPointSymbol innerHTML when it's empty -->
				</marker>
			</defs>
			<style type="text/css">
				polyline,
				polygon {
					marker: url(#surveyPointSymbol);
				}

			</style>
			<polyline class="surveyStation surveyData" points="14826.706,-17659.494"
				style="marker:url(#surveyStationSymbol)" />
			<polygon class="surveyData"
				points="14829.515,-17667.713 14829.312,-17669.291 14829.313,-17669.337 14829.23,-17669.378 14829.123,-17669.346 14829.119,-17669.272" />
			<polyline class="surveyData"
				points="14828.323,-17669.127 14828.33,-17669.392 14828.195,-17669.382 14828.125,-17669.341 14828.069,-17669.185 14828.092,-17669.124" />
			<polyline class="surveyData"
				points="14806.678,-17658.043 14806.886,-17658.026 14806.887,-17658.168 14806.687,-17658.15" />
			<polyline class="surveyData"
				points="14765.287,-17645.624 14764.979,-17648.853 14765.582,-17649.124 14765.301,-17649.888 14765.145,-17649.81 14763.996,-17653.096 14765.028,-17653.591 14765.335,-17658.145 14765.677,-17658.828" />
			<circle id="unsavedShot" cx="14775.287" cy="-17655.624">
		</svg>
		<table style="margin-top: -30px">
			<tr>
				<td onclick="livemap_hide_points();">☐</td>
				<td onclick="livemap_show_points();">☒</td>
				<td>&nbsp;</td>
				<td onclick="livemap_pan('N');">▲</td>
				<td>&nbsp;</td>
				<td onclick="livemap_zoom_in();" style="font-weight: bold; padding-left: 20px;">+</td>
			</tr>
			<tr>
				<td>&nbsp;</td>
				<td>&nbsp;</td>
				<td onclick="livemap_pan('W');">◀︎</td>
				<td onclick="livemap_recenter();">❖</td>
				<td onclick="livemap_pan('E');">►</td>
				<td>&nbsp;</td>
			</tr>
			<tr>
				<td>&nbsp;</td>
				<td>&nbsp;</td>
				<td>&nbsp;</td>
				<td onclick="livemap_pan('S');">▼</td>
				<td>&nbsp;</td>
				<td onclick="livemap_zoom_out();" style="font-weight: bold; padding-left: 20px;">−</td>&nbsp;
			</tr>
		</table>
	</div>

	<img id="editAtmosphereAndPrismOffsetsIcon" src="img/arrows.svg" onclick="show_on_the_fly_adjustments_popup();">
	<img id="showUtilitiesIcon" src="img/gear.svg" onclick="show_utilities_popup();">
	<span class="info">
		<span>
			<span id="atmosphericConditions">Atmosphere:</span><br>
			<span id="prismOffsets">Prism Offsets:</span>
		</span>
		<span>
			<span id="dateAndTime"></span>
		</span>
	</span>

	<div class=" setup">
		<div class="formcollectionheader" onclick="collapse(this);">
			Setup <span class="collapser">‣</span><span class="expander" hidden>▾</span>
		</div>

		<div class="formcollection collapsible" hidden>
			<form id="setConfigsForm">
				<span onclick="collapse(this);">
					<b>Set Configs</b> <span class="collapser">‣</span><span class="expander" hidden>▾</span>
				</span>
				<span class="collapsible" hidden>
					<hr>
					<label for="setConfigsFormPortMenu">Port:</label>
					<select id="setConfigsFormPortMenu" name="port"
						onchange="toggle_total_station_menus(this.value);"></select>
					<label for="setConfigsFormMakeMenu"><br>Make:</label>
					<select id="setConfigsFormMakeMenu" name="make"
						onchange="update_dependent_model_menu(this.value);"></select>
					<label for="setConfigsFormModelMenu"><br>Model:</label>
					<select id="setConfigsFormModelMenu" name="model"></select>
					<label for="setConfigsFormLimit"><br>Backsight Error Limit (cm):</label>
					<input type="text" id="setConfigsFormLimit" name="limit" pattern="\d{1,2}" />
					<br>
					<input type="button" id="setConfigsFormButton" value="Set Configs" onclick="set_configs();" />
				</span>
			</form>

			<form id="saveNewSiteForm">
				<span onclick="collapse(this);">
					<b>Save New Site</b> <span class="collapser">‣</span><span class="expander" hidden>▾</span>
				</span>
				<span class="collapsible" hidden>
					<hr>
					<label for="saveNewSiteFormSiteName">Name:</label>
					<input type="text" id="saveNewSiteFormSiteName" name="name" oninput="toggle_button(this);"
						required />
					<label for=" saveNewSiteFormSiteDescription"><br>Description:</label>
					<input type="text" id="saveNewSiteFormSiteDescription" name="description" />
					<br>
					<input type="button" id="saveNewSiteFormButton" value="Save New Site" onclick="save_new_site();"
						disabled />
				</span>
			</form>

			<form id="deleteSiteForm">
				<span onclick="collapse(this);">
					<b>Delete Site</b> <span class="collapser">‣</span><span class="expander" hidden>▾</span>
				</span>
				<span class="collapsible" hidden>
					<hr>
					<label for="deleteSiteFormSitesMenu">Site:</label>
					<select id="deleteSiteFormSitesMenu" class="sitesmenu" name="sites_id"
						onchange="update_description(this, 'deleteSiteFormSiteDescription'); toggle_button(this);"
						required>
					</select>
					<img class="infobutton" id="deleteSiteFormSiteDescription" src="img/info.svg">
					<br>
					<input type="button" id="deleteSiteFormButton" value="Delete Site" onclick="delete_site();"
						disabled />
				</span>
			</form>

			<form id="saveNewStationForm">
				<span onclick="collapse(this);">
					<b>Save New Station</b> <span class="collapser">‣</span><span class="expander" hidden>▾</span>
				</span>
				<span class="collapsible" hidden>
					<hr>
					<label for="saveNewStationFormSitesMenu">Site:</label>
					<select id="saveNewStationFormSitesMenu" class="sitesmenu" name="sites_id"
						onchange="update_description(this, 'saveNewStationFormSiteDescription'); toggle_button(this);"
						required>
					</select>
					<img class="infobutton" id="saveNewStationFormSiteDescription" src="img/info.svg">
					<label for="saveNewStationFormName"><br>Name:</label>
					<input type="text" id="saveNewStationFormName" name="name" oninput="toggle_button(this);"
						required />
					<label for="saveNewStationDescription"><br>Description:</label>
					<input type="text" id="saveNewStationDescription" name="description" />
					<label for="saveNewStationCoordinateSystem"><br>Coordinate System:</label>
					<select id="saveNewStationCoordinateSystem" name="coordinatesystem"
						onchange="update_required_new_site_fields(this); toggle_button(this);" required>
						<option></option>
						<option value='Site'>Site</option>
						<option value='UTM'>UTM</option>
						<option value='Lat/Lon'>Lat/Lon</option>
					</select>
					<label for="saveNewStationNorthing" id="saveNewStationNorthingLabel" hidden><br>Northing:</label>
					<input type="text" id="saveNewStationNorthing" name="northing" oninput="toggle_button(this);"
						hidden />
					<label for="saveNewStationEasting" id="saveNewStationEastingLabel" hidden><br>Easting:</label>
					<input type="text" id="saveNewStationEasting" name="easting" oninput="toggle_button(this);"
						hidden />
					<label for="saveNewStationLatitude" id="saveNewStationLatitudeLabel" hidden><br>Latitude:</label>
					<input type="text" id="saveNewStationLatitude" name="latitude" oninput="toggle_button(this);"
						hidden />
					<label for="saveNewStationLongitude" id="saveNewStationLongitudeLabel" hidden><br>Longitude:</label>
					<input type="text" id="saveNewStationLongitude" name="longitude" oninput="toggle_button(this);"
						hidden />
					<label for="saveNewStationElevation" id="saveNewStationElevationLabel" hidden><br>Elevation:</label>
					<input type="text" id="saveNewStationElevation" name="elevation" oninput="toggle_button(this);"
						hidden />
					<label for="saveNewStationUTMZone" id="saveNewStationUTMZoneLabel" hidden><br>UTMZone:</label>
					<input type="text" id="saveNewStationUTMZone" name="utmzone" oninput="toggle_button(this);"
						pattern="([1-5]\d?|[6-9]|60)[cCdDeEfFgGhHjJkKlLmMnNpPqQrRsStTuUvVwWxX]" hidden />
					<br>
					<input type="button" id="saveNewStationFormButton" value="Save New Station"
						onclick="save_new_station();" disabled />
				</span>
			</form>

			<form id="deleteStationForm">
				<span onclick="collapse(this);">
					<b>Delete Station</b> <span class="collapser">‣</span><span class="expander" hidden>▾</span>
				</span>
				<span class="collapsible" hidden>
					<hr>
					<label for="deleteStationFormSitesMenu">Site:</label>
					<select id="deleteStationFormSitesMenu" class="sitesmenu" name="sites_id"
						onchange="update_description(this, 'deleteStationFormSiteDescription'); update_dependent_station_menu(this, 'deleteStationFormStationsMenu'); toggle_button(this);"
						required>
					</select>
					<img class="infobutton" id="deleteStationFormSiteDescription" src="img/info.svg">
					<label for="deleteStationFormStationsMenu"><br>Station:</label>
					<select id="deleteStationFormStationsMenu" name="stations_id"
						onchange="update_description(this, 'deleteStationFormStationDescription'); toggle_button(this);"
						required>
					</select>
					<img class="infobutton" id="deleteStationFormStationDescription" src="img/info.svg">
					<br>
					<input type="button" id="deleteStationFormButton" value="Delete Station" onclick="delete_station();"
						disabled />
				</span>
			</form>

			<form id="saveNewClassForm">
				<span onclick="collapse(this);">
					<b>Save New Class</b> <span class="collapser">‣</span><span class="expander" hidden>▾</span>
				</span>
				<span class="collapsible" hidden>
					<hr>
					<label for="saveNewClassFormClassName">Name:</label>
					<input type="text" id="saveNewClassFormClassName" name="name" oninput="toggle_button(this)"
						required />
					<label for="saveNewClassFormClassDescription"><br>Description:</label>
					<input type="text" id="saveNewClassFormClassDescription" name="description" />
					<br>
					<input type="button" id="saveNewClassFormButton" value="Save New Class" onclick="save_new_class();"
						disabled />
				</span>
			</form>

			<form id="deleteClassForm">
				<span onclick="collapse(this);">
					<b>Delete Class</b> <span class="collapser">‣</span><span class="expander" hidden>▾</span>
				</span>
				<span class="collapsible" hidden>
					<hr>
					<label for="deleteClassFormClassesMenu">Class:</label>
					<select id="deleteClassFormClassesMenu" class="classesmenu" name="classes_id"
						onchange="update_description(this, 'deleteClassFormClassDescription'); toggle_button(this);"
						required>
					</select>
					<img class="infobutton" id="deleteClassFormClassDescription" src="img/info.svg">
					<br>
					<input type="button" id=" deleteClassFormButton" value="Delete Class" onclick="delete_class();"
						disabled />
				</span>
			</form>

			<form id="saveNewSubclassForm">
				<span onclick="collapse(this);">
					<b>Save New Subclass</b> <span class="collapser">‣</span><span class="expander" hidden>▾</span>
				</span>
				<span class="collapsible" hidden>
					<hr>
					<label for="saveNewSubclassFormClassesMenu">Class:</label>
					<select id="saveNewSubclassFormClassesMenu" class="classesmenu" name="classes_id"
						onchange="update_description(this, 'saveNewSubclassFormClassDescription'); toggle_button(this);"
						required>
					</select>
					<img class="infobutton" id="saveNewSubclassFormClassDescription" src="img/info.svg">
					<label for="saveNewSubclassFormSubclassName"><br>Name:</label>
					<input type="text" id="saveNewSubclassFormSubclassName" name="name" oninput="toggle_button(this);"
						required />
					<label for="saveNewSubclassFormSubclassDescription"><br>Description:</label>
					<input type="text" id="saveNewSubclassFormSubclassDescription" name="description" />
					<br>
					<input type="button" id="saveNewSubclassFormButton" value="Save New Subclass"
						onclick="save_new_subclass();" disabled />
				</span>
			</form>

			<form id="deleteSubclassForm">
				<span onclick="collapse(this);">
					<b>Delete Subclass</b> <span class="collapser">‣</span><span class="expander" hidden>▾</span>
				</span>
				<span class="collapsible" hidden>
					<hr>
					<label for="deleteSubclassFormClassesMenu">Class:</label>
					<select id="deleteSubclassFormClassesMenu" class="classesmenu" name="classes_id"
						onchange="update_description(this, 'deleteSubclassFormClassDescription'); update_dependent_subclass_menu(this, 'deleteSubclassFormSubclassesMenu'); toggle_button(this);"
						required>
					</select>
					<img class="infobutton" id="deleteSubclassFormClassDescription" src="img/info.svg">
					<label for="deleteSubclassFormSubclassesMenu"><br>Subclass:</label>
					<select id="deleteSubclassFormSubclassesMenu" name="subclasses_id"
						onchange="update_description(this, 'deleteSubclassFormSubclassDescription'); toggle_button(this);"
						required>
					</select>
					<img class="infobutton" id="deleteSubclassFormSubclassDescription" src="img/info.svg">
					<br>
					<input type="button" id=" deleteSubclassFormButton" value="Delete Subclass"
						onclick="delete_subclass();" disabled />
				</span>
			</form>
		</div>
	</div>

	<div class="usage">
		<div class="formcollectionheader" onclick="collapse(this);">
			Surveying <span class="collapser">‣</span><span class="expander" hidden>▾</span>
		</div>

		<div class="formcollection collapsible" hidden>
			<form id="startNewSessionForm">
				<span onclick="collapse(this);">
					<b>Start New Session</b> <span class="collapser">‣</span><span class="expander" hidden>▾</span>
				</span>
				<span class="collapsible" hidden>
					<hr>
					<img id="startNewSessionFormIndicator" src="img/cylon.svg" hidden />
					<label for="startNewSessionFormLabel">Label:</label>
					<input type="text" id="startNewSessionFormLabel" name="label" oninput="toggle_button(this);"
						required />
					<label for="startNewSessionFormSurveyor"><br>Surveyor:</label>
					<input type="text" id="startNewSessionFormSurveyor" name="surveyor" oninput="toggle_button(this);"
						required />
					<label for="startNewSessionFormSitesMenu"><br>Site:</label>
					<select id="startNewSessionFormSitesMenu" class="sitesmenu" name="sites_id"
						onchange="update_description(this, 'startNewSessionFormSiteDescription'); update_dependent_station_menu(this, 'startNewSessionFormOccupiedPointMenu'); toggle_button(this);"
						required>
					</select>
					<img class="infobutton" id="startNewSessionFormSiteDescription" src="img/info.svg">
					<label for="startNewSessionFormOccupiedPointMenu"><br>Occupied Point:</label>
					<select id="startNewSessionFormOccupiedPointMenu" name="occupied_point_id" onchange="update_description(this, 'startNewSessionFormOccupiedPointDescription');
					update_backsight_station_menu(this); toggle_button(this);" required>
					</select>
					<img class="infobutton" id="startNewSessionFormOccupiedPointDescription" src="img/info.svg">
					<label for="startNewSessionFormSessionTypeMenu"><br>Session Type:</label>
					<select id="startNewSessionFormSessionTypeMenu" name="sessiontype"
						onchange="update_required_new_session_fields(this); toggle_button(this);" required>
						<option></option>
						<option value="Backsight">Backsight</option>
						<option value="Azimuth">Azimuth</option>
					</select>
					<label for="startNewSessionFormBacksightStationMenu"
						id="startNewSessionFormBacksightStationMenuLabel" hidden><br>Backsight
						Station:</label>
					<select id="startNewSessionFormBacksightStationMenu" name="backsight_station_id"
						onchange="update_description(this, 'startNewSessionFormBacksightStationDescription'); toggle_button(this);"
						hidden>
					</select>
					<img class="infobutton" id="startNewSessionFormBacksightStationDescription" src="img/info.svg"
						hidden>
					<label for="startNewSessionFormPrismHeight" id="startNewSessionFormPrismHeightLabel"
						hidden><br>Prism
						Height:</label>
					<input type="text" id="startNewSessionFormPrismHeight" name="prism_height"
						pattern="\d\.?(\.\d{1,3})?" oninput="toggle_button(this);" hidden />
					<label for="startNewSessionFormInstrumentHeight" id="startNewSessionFormInstrumentHeightLabel"
						hidden><br>Instrument Height
						(m):</label>
					<input type="text" id="startNewSessionFormInstrumentHeight" name="instrument_height"
						pattern="\d\.?(\.\d{1,3})?" oninput="toggle_button(this);" hidden />
					<label for="startNewSessionFormAzimuth" id="startNewSessionFormAzimuthLabel" hidden><br>Azimuth
						(ddd.mmss):</label>
					<input type="text" id="startNewSessionFormAzimuth" name="azimuth"
						pattern="(\d|[1-9]\d|[1-2]\d{2}|3[0-5]\d)\.[0-5][0-9][0-5][0-9]" oninput="toggle_button(this);"
						hidden />
					<input type="hidden" id="currentSessionLabel" />
					<input type="hidden" id="currentSessionStarted" />
					<input type="hidden" id="currentSessionSite" />
					<input type="hidden" id="currentSessionOccupiedPoint" />
					<input type="hidden" id="currentSessionInstrumentHeight" />
					<br>
					<input type="button" id="startNewSessionFormButton" value="Start New Session"
						onclick="start_new_session();" disabled>
				</span>
			</form>

			<form id="startNewGroupingForm">
				<span onclick="collapse(this);">
					<b>Start New Grouping</b> <span class="collapser">‣</span><span class="expander" hidden>▾</span>
				</span>
				<span class="collapsible" hidden>
					<hr>
					<label for="startNewGroupingFormLabel">Label:</label>
					<input type="text" id="startNewGroupingFormLabel" name="label" oninput="toggle_button(this);"
						required />
					<label for="startNewGroupingFormGeometriesMenu"><br>Geometry:</label>
					<select id="startNewGroupingFormGeometriesMenu" class="geometriesmenu" name="geometries_id"
						onchange="update_description(this, 'startNewGroupingFormGeometryDescription'); toggle_button(this);"
						required>
					</select>
					<img class="infobutton" id="startNewGroupingFormGeometryDescription" src="img/info.svg">
					<label for="startNewGroupingFormClassesMenu"><br>Class:</label>
					<select id="startNewGroupingFormClassesMenu" class="classesmenu" name="classes_id"
						onchange="update_description(this, 'startNewGroupingFormClassDescription'); update_dependent_subclass_menu(this, 'startNewGroupingFormSubclassesMenu'); toggle_button(this);"
						required>
					</select>
					<img class="infobutton" id="startNewGroupingFormClassDescription" src="img/info.svg">
					<label for="startNewGroupingFormSubclassesMenu"><br>Subclass:</label>
					<select id="startNewGroupingFormSubclassesMenu" name="subclasses_id"
						onchange="handle_survey_station_subclass(this); update_description(this, 'startNewGroupingFormSubclassDescription'); toggle_button(this);"
						required>
					</select>
					<img class="infobutton" id="startNewGroupingFormSubclassDescription" src="img/info.svg">
					<label for="startNewGroupingFormDescription"><br>Description:</label>
					<input type="text" id="startNewGroupingFormDescription" name="description" />
					<input type="hidden" id="currentGroupingLabel" />
					<input type="hidden" id="currentGroupingGeometry" />
					<input type="hidden" id="currentGroupingClass" />
					<input type="hidden" id="currentGroupingSubclass" />
					<input type="hidden" id="currentGroupingDescription" />
					<input type="hidden" id="currentGroupingNumberOfShots" />
					<br>
					<input type="button" id="startNewGroupingFormButton" value="Start New Grouping"
						onclick="start_new_grouping();" disabled />
				</span>
			</form>

			<img id="showLiveMapIcon" src="img/map.svg" onclick="show_livemap_popup();">
			<span class="currentSurveyingInfo">
				<b>Current Session:</b><br>
				<span id="currentSessionInfo"><b>Current Session:</b><br></span>
				<img class="infobutton" id="currentSessionDetails" src="img/info.svg">
			</span><br>
			<span class="currentSurveyingInfo">
				<b>Current Grouping:</b><br>
				<span id="currentGroupingInfo"></span>
				<img class="infobutton" id="currentGroupingDetails" src="img/info.svg">
			</span>

			<form id="takeShotForm">
				<input type="button" id="takeShotFormButton" value="Take Shot" onclick="take_shot();" disabled />
			</form>
			<form id="cancelShotForm" hidden>
				<input type="button" id="cancelShotFormButton" value="Cancel Shot" onclick="cancel_shot();" />
				<img id="takeShotFormIndicator" src="img/cylon.svg" /><br>
			</form>
			<form id="saveLastShotForm" hidden>
				<label for="saveLastShotFormLabel">Label:</label>
				<input type="text" id="saveLastShotFormLabel" name="label" />
				<label for="saveLastShotFormComment"><br>Comment:</label>
				<input type="text" id="saveLastShotFormComment" name="comment" /><br>
				<input type="button" id="saveLastShotFormButton" value="Save Last Shot" onclick="save_last_shot();" />
				<input type="button" id="discardLastShotFormButton" value="Discard Last Shot"
					onclick="discard_last_shot();" />
			</form>
		</div>
	</div>

	<div id="outputBox"></div>
</body>
